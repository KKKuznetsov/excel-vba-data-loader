# Excel VBA Data Loader

## Описание

Данный проект представляет собой набор VBA-макросов для Excel, предназначенных для загрузки и объединения данных из нескольких источников баз данных: **Сенсус**, **Сенсус удалённое** и **Росздравнадзор (РЗН)**. Скрипты позволяют применять фильтры, очищать лист перед загрузкой, выполнять SQL-запросы и вставлять результаты в лист Excel "Разбор".

Код изолирован в виде модулей `.bas` и предназначен только для демонастрации кода.

## Основной функционал

- Загрузка и объединение данных из 3-х источников
- Построение SQL-запроса с фильтрами по ИНН, адресу, названию и т.д.
- Подключение к SQL Server с использованием ADO
- Автоматическое восстановление состояния фильтров
- Проверка активного листа и структуры данных перед запуском

## Структура

| Файл | Описание |
|------|----------|
| `GetRowsFromSenAndRZN.bas` | Основная процедура запуска загрузки из всех источников |
| `LoadAndInsertRZN.bas`     | Процедура подключения к БД, получения данных и вызова вставки |
| `BuildCensusAndRZNsql.bas` | Построение SQL-запроса с учётом фильтров пользователя |
